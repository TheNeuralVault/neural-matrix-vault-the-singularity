let currentPage='home';let selectedElement=null;let siteData={'home':[],'about':[],'services':[],'contact':[]};document.addEventListener('DOMContentLoaded',()=>{initDragAndDrop();initAnalytics();});function initDragAndDrop(){const draggables=document.querySelectorAll('.draggable-item');const zone=document.getElementById('workspace');draggables.forEach(item=>{item.addEventListener('dragstart',(e)=>{e.dataTransfer.setData('type',item.getAttribute('data-type'));});});zone.addEventListener('dragover',(e)=>{e.preventDefault();zone.style.borderColor='#00f3ff';});zone.addEventListener('dragleave',()=>{zone.style.borderColor='transparent';});zone.addEventListener('drop',(e)=>{e.preventDefault();zone.style.borderColor='transparent';const type=e.dataTransfer.getData('type');addElementToPage(type);});}function addElementToPage(type){const zone=document.getElementById('workspace');const el=document.createElement('div');el.classList.add('element');el.setAttribute('data-id',Date.now());if(type==='header'){el.innerHTML='<nav style="background:#000; color:#fff; padding:20px; display:flex; justify-content:space-between;"><span>BRAND</span><span>MENU</span></nav>';}else if(type==='hero'){el.innerHTML='<div style="background:#333; color:#fff; padding:50px; text-align:center;"><h1>HERO TITLE</h1><p>Subtitle text goes here.</p></div>';}else if(type==='button'){el.innerHTML='<button style="background:#00f3ff; border:none; padding:10px 20px; font-weight:bold;">CLICK ME</button>';}else if(type==='text-block'){el.innerHTML='<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>';}else if(type==='image'){el.innerHTML='<img src="https://via.placeholder.com/800x400" style="width:100%; max-width:100%;">';}else if(type==='video'){el.innerHTML='<div style="background:#000; color:#fff; height:200px; display:flex; align-items:center; justify-content:center;">VIDEO PLACEHOLDER</div>';}el.addEventListener('click',(e)=>{e.stopPropagation();selectElement(el);});zone.appendChild(el);const ph=document.querySelector('.placeholder-msg');if(ph)ph.remove();}function selectElement(el){document.querySelectorAll('.element').forEach(e=>e.classList.remove('selected'));el.classList.add('selected');selectedElement=el;document.getElementById('no-selection').style.display='none';document.getElementById('editor-controls').style.display='block';document.getElementById('prop-text').value=el.innerText;}document.getElementById('prop-text').addEventListener('input',(e)=>{if(selectedElement){if(selectedElement.querySelector('img'))return;selectedElement.innerText=e.target.value;}});document.getElementById('prop-color').addEventListener('input',(e)=>{if(selectedElement){selectedElement.children[0].style.backgroundColor=e.target.value;document.getElementById('hex-val').innerText=e.target.value;}});window.deleteSelected=function(){if(selectedElement){selectedElement.remove();selectedElement=null;document.getElementById('editor-controls').style.display='none';document.getElementById('no-selection').style.display='block';}};window.switchLeftTab=function(tab){document.querySelectorAll('.left-panel').forEach(p=>p.classList.remove('active'));document.getElementById(`panel-${tab}`).classList.add('active');document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));event.currentTarget.classList.add('active');};window.loadPage=function(pageName){currentPage=pageName;document.getElementById('current-page-label').innerText=pageName.toUpperCase();document.getElementById('workspace').innerHTML='<div class="placeholder-msg">/// EDITING '+pageName.toUpperCase()+' ///</div>';document.querySelectorAll('.page-item').forEach(i=>i.classList.remove('active'));event.currentTarget.classList.add('active');};window.openAnalytics=function(){document.getElementById('modal-analytics').style.display='flex';};window.openSettings=function(){document.getElementById('modal-settings').style.display='flex';};window.closeModal=function(id){document.getElementById(id).style.display='none';};function initAnalytics(){const ctx=document.getElementById('trafficChart');if(ctx){new Chart(ctx,{type:'line',data:{labels:['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],datasets:[{label:'TRAFFIC_FLOW',data:[12,19,15,25,22,30,45],borderColor:'#00f3ff',backgroundColor:'rgba(0, 243, 255, 0.1)',tension:0.4,fill:true}]},options:{responsive:true,plugins:{legend:{display:false}},scales:{x:{grid:{color:'#222'}},y:{grid:{color:'#222'}}}}});}}window.exportSite=function(){const btn=document.querySelector('.sys-btn.primary');btn.innerText="COMPILING...";setTimeout(()=>{alert("SITE PACKAGE COMPILED. DOWNLOADING JSON...");btn.innerText="DEPLOY";},1500);};
